- #freqtrade
- 假设有x个pair,第一个pair买入的量为1/x,第二个买入的量为(1-1/x)/x,第三个pair买入的量为(1-1/x-(1-1/x))/x,以此类推,那么所有pair买入的量之和为?
-
- 好的，我们来逐步计算这个问题。
  
  假设总共有 *x* 个 pair。
  令 *A<sub>i</sub>* 为第 *i* 个 pair 买入的量。
  
  1.  **第一个 pair (i=1):**
      *A<sub>1</sub>* = 1 / *x*
  
  2.  **第二个 pair (i=2):**
      买入前剩余的比例 = 1 - *A<sub>1</sub>* = 1 - (1/*x*)
      *A<sub>2</sub>* = (剩余比例) / *x* = (1 - 1/*x*) / *x*
  
  3.  **第三个 pair (i=3):**
      买入前剩余的比例 = 1 - *A<sub>1</sub>* - *A<sub>2</sub>*
      = 1 - (1/*x*) - (1 - 1/*x*)/*x*
      = (1 - 1/*x*) - (1 - 1/*x*)/*x*  （从 1 - 1/*x* 中提出 (1 - 1/*x*)）
      = (1 - 1/*x*) * (1 - 1/*x*)
      = (1 - 1/*x*)²
      *A<sub>3</sub>* = (剩余比例) / *x* = (1 - 1/*x*)² / *x*
  
  4.  **推广到第 i 个 pair:**
      我们可以观察到一个规律：在买入第 *i* 个 pair 之前，剩余的比例是 (1 - 1/*x*)<sup>*(i-1)*</sup>。
      所以，第 *i* 个 pair 买入的量为：
      *A<sub>i</sub>* = (1 - 1/*x*)<sup>*(i-1)*</sup> / *x*
  
  5.  **计算所有 pair 买入量的总和:**
      总和 S = *A<sub>1</sub>* + *A<sub>2</sub>* + *A<sub>3</sub>* + ... + *A<sub>x</sub>*
      S = Σ<sub>*i*=1</sub><sup>*x*</sup> *A<sub>i</sub>*
      S = Σ<sub>*i*=1</sub><sup>*x*</sup> [ (1 - 1/*x*)<sup>*(i-1)*</sup> / *x* ]
      S = (1/*x*) * Σ<sub>*i*=1</sub><sup>*x*</sup> [ (1 - 1/*x*)<sup>*(i-1)*</sup> ]
  
      括号内的求和部分是一个**等比数列**（Geometric Series），其中：
      *   首项 (a) = (1 - 1/*x*)<sup>0</sup> = 1
      *   公比 (r) = 1 - 1/*x*
      *   项数 (n) = *x*
  
      等比数列求和公式为：S<sub>n</sub> = a * (1 - r<sup>n</sup>) / (1 - r)
      将我们的值代入：
      Σ<sub>*i*=1</sub><sup>*x*</sup> [ (1 - 1/*x*)<sup>*(i-1)*</sup> ] = 1 * [ 1 - (1 - 1/*x*)<sup>*x*</sup> ] / [ 1 - (1 - 1/*x*) ]
      = [ 1 - (1 - 1/*x*)<sup>*x*</sup> ] / [ 1/*x* ]
      = *x* * [ 1 - (1 - 1/*x*)<sup>*x*</sup> ]
  
      现在，将这个结果代回总和 S 的表达式：
      S = (1/*x*) * { *x* * [ 1 - (1 - 1/*x*)<sup>*x*</sup> ] }
      S = 1 - (1 - 1/*x*)<sup>*x*</sup>
  
  **另一种更简洁的思路：**
  
  *   考虑总比例为 1。
  *   每次买入都是当前剩余比例的 1/*x*。
  *   第 1 次买入后，剩余比例 = 1 - 1/*x*
  *   第 2 次买入后，剩余比例 = (1 - 1/*x*) - (1 - 1/*x*)/*x* = (1 - 1/*x*) * (1 - 1/*x*) = (1 - 1/*x*)²
  *   第 *i* 次买入后，剩余比例 = (1 - 1/*x*)<sup>*i*</sup>
  *   经过 *x* 次买入后，最终剩余的比例 = (1 - 1/*x*)<sup>*x*</sup>
  *   那么，所有 pair 买入的总量 = 初始总量 - 最终剩余量 = 1 - (1 - 1/*x*)<sup>*x*</sup>
  
  **结论:**
  
  所有 pair 买入的量之和为 $$1-(1-1/x)^x$$。前2/3的pair买入的量之和为$$1-(1-1/x)^{2x/3}$$
  
  有趣的是，当 x 趋向于无穷大时，(1 - 1/x)<sup>x</sup> 的极限是 1/e (其中 e 是自然对数的底数，约等于 2.71828)。所以，如果 pair 的数量非常多，买入的总量将趋近于 1 - 1/e ≈ 1 - 0.367879 = 0.632121。
-
- 当x=1时总买入量为1,当x=20时总买入的量为0.6415,当x=32时总买入的量为0.6379
- 当只买入前2/3时,x=20总买入的量为0.49536,x=32总买入的量为0.492