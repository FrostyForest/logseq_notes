- #crypto #freqtrade
- ## 杠杆交易
  
  **测试阶段功能**
  
  此功能仍处于测试阶段。如果你发现任何你认为错误的地方，请通过 Discord 或 Github Issue 告知我们。
  
  **一个账户上运行多个机器人**
  
  你不能在同一个账户上使用杠杆运行 2 个机器人。对于杠杆/保证金交易，freqtrade 假设它是该账户的唯一用户，并且所有清算水平都是基于此假设计算的。
  
  **使用杠杆交易风险很高**
  
  在使用现货市场进行实盘交易并获得正收益之前，不要使用杠杆 > 1 的策略。检查你的策略的止损。杠杆为 2 时，0.5 (50%) 的止损太低，这些交易将在达到止损之前被强制平仓。对于使用此软件或此模式造成的最终损失，我们不承担任何责任。
  
  请仅在你了解 freqtrade (和你的策略) 的工作原理时才使用高级交易模式。此外，永远不要冒险超过你能承受的损失。
  
  如果你已经有一个现有的策略，请阅读[策略迁移指南](https://www.freqtrade.io/en/stable/strategy-v2-to-v3/)，将你的策略从 freqtrade v2 策略迁移到可以做空和交易期货的版本 3 策略。
  
  **做空**
  
  当 `trading_mode` 设置为 `spot` 时，无法做空。要做空交易，必须将 `trading_mode` 设置为 `margin` (当前不可用) 或 `futures`，并将 `margin_mode` 设置为 `cross` (当前不可用) 或 `isolated`。
  
  对于做空策略，策略类必须设置类变量 `can_short = True`。
  
  有关如何设置信号以开仓和平仓空头交易的说明，请阅读[策略定制](https://www.freqtrade.io/en/stable/strategy-customization/)。
  
  **了解 trading_mode**
  
  可能的值为：`spot` (默认)、`margin` (当前不可用) 或 `futures`。
  
  **现货 (Spot)**
  
  常规交易模式 (低风险)
  
  *   仅做多 (不做空)。
  *   无杠杆。
  *   无强制平仓。
  *   获得的利润/损失等于资产价值的变化 (减去交易费用)。
  
  **杠杆交易模式**
  
  使用杠杆，交易者从交易所借入资金。必须将资金全额偿还给交易所 (可能有利息)，交易者保留使用借入资金进行的任何交易的任何利润，或支付任何损失。
  
  由于必须始终偿还资金，因此当杠杆账户中资产的总价值下降到某个点 (损失的总价值小于交易者在杠杆账户中实际拥有的抵押品价值) 时，交易所将强制平仓 (强制出售交易者的资产) 使用借入资金进行的交易，以确保交易者有足够的资金将借入的资产偿还给交易所。交易所还将收取强平费用，这会增加交易者的损失。
  
  因此，如果你不完全了解你在做什么，请不要进行杠杆交易。杠杆交易风险很高，并且可能导致你的资产价值迅速降至 0，并且没有再次增值的机会。
  
  **保证金 (Margin) (当前不可用)**
  
  交易发生在现货市场上，但交易所会借给你与所选杠杆相等的金额的货币。你将借给你的金额连同利息一起偿还给交易所，你的利润/亏损将乘以指定的杠杆。
  
  **期货 (Futures)**
  
  永续掉期合约 (也称为永续期货) 是以与它们所基于的标的资产紧密相关的价格进行交易的合约 (例如)。你不是在交易实际资产，而是在交易衍生合约。与期货或期权合约不同，永续掉期合约可以无限期地持续下去。
  
  除了期货合约价格变化带来的收益/损失外，交易者还交换资金费用，资金费用是根据期货合约与标的资产之间的价格差得出的金额的收益/损失。期货合约与标的资产之间的价格差因交易所而异。
  
  要在期货市场进行交易，你必须将 `trading_mode` 设置为 `"futures"`。你还必须选择一个 “保证金模式” (解释如下) - 目前 freqtrade 仅支持逐仓保证金。
  
  ```json
  "trading_mode": "futures",
  "margin_mode": "isolated"
  ```
  
  **交易对命名**
  
  Freqtrade 遵循 ccxt 的期货命名约定。因此，期货交易对的命名方式为 `基础货币/报价货币:结算货币` (例如 `ETH/USDT:USDT`)。
  
  **保证金模式**
  
  除了 `trading_mode` 之外 - 你还必须配置你的 `margin_mode`。虽然 freqtrade 目前仅支持一种保证金模式，但这种情况将会改变，现在配置它，你就为将来的更新做好了准备。
  
  可能的值为：`isolated` 或 `cross` (当前不可用)。
  
  **逐仓保证金模式**
  
  每个市场 (交易对) 在一个单独的账户中保留抵押品。
  
  ```json
  "margin_mode": "isolated"
  ```
  
  **全仓保证金模式 (当前不可用)**
  
  一个账户用于在市场 (交易对) 之间共享抵押品。必要时从总账户余额中提取保证金以避免强平。
  
  ```json
  "margin_mode": "cross"
  ```
  
  请阅读支持此模式的交易所的[交易所特定说明](https://www.freqtrade.io/en/stable/exchange-specific-notes/)以及它们之间的区别。
  
  **设置要使用的杠杆**
  
  不同的策略和风险状况将需要不同水平的杠杆。虽然你可以配置一个静态杠杆值 - freqtrade 为你提供了通过[策略杠杆回调函数](https://www.freqtrade.io/en/stable/strategy-callbacks/#leverage)调整此值的灵活性 - 这允许你按交易对使用不同的杠杆，或根据有利于你的策略结果的其他因素使用不同的杠杆。
  
  如果未实现，杠杆默认为 1 倍 (无杠杆)。
  
  **警告**
  
  更高的杠杆也等于更高的风险 - 请确保你完全理解使用杠杆的影响！
  
  **了解 liquidation_buffer**
  
  默认为 0.05
  
  一个比率，指定在强平价格和止损之间放置多大的安全网，以防止仓位达到强平价格。此人工强平价格计算如下：
  
  ```
  freqtrade_liquidation_price = liquidation_price ± (abs(open_rate - liquidation_price) * liquidation_buffer)
  
    ± = + 代表做多
    ± = - 代表做空
  ```
  
  可能的值为 0.0 到 0.99 之间的任何浮点数
  
  例如：如果以 10 币/USDT 的价格开仓，并且此交易的强平价格为 8 币/USDT，则在 `liquidation_buffer` 设置为 0.05 的情况下，此交易的最小止损将为
  
  `liquidation_buffer` 为 0.0 或较低的 `liquidation_buffer` 可能会导致强平，并产生强平费用
  
  目前，Freqtrade 能够计算强平价格，但不会计算强平费用。将你的 `liquidation_buffer` 设置为 0.0 或使用较低的 `liquidation_buffer` 可能会导致你的仓位被强平。Freqtrade 不会跟踪强平费用，因此强平将导致你的机器人的盈亏结果不准确。如果你使用较低的 `liquidation_buffer`，建议使用 `stoploss_on_exchange` (如果你的交易所支持)。
  
  **不可用的资金费率**
  
  对于期货数据，交易所通常提供期货 K 线、标记价格和资金费率。然而，通常情况下，虽然 K 线和标记价格可能可用，但资金费率不可用。这会影响回测时间范围，即你可能只能测试最近的时间范围，而不能测试更早的时间范围，遇到 `No data found. Terminating.` 错误。要解决这个问题，请添加 [configuration.md](https://www.freqtrade.io/en/stable/configuration/#general-options) 中列出的 `futures_funding_rate` 配置选项，建议你将其设置为 0，除非你知道你的交易对、交易所和时间范围的给定特定资金费率。将其设置为 0 以外的任何值都会对你在策略中的利润计算产生重大影响，例如在 `custom_exit`、`custom_stoploss` 等函数中。
  
  这将意味着你的回测是不准确的。
  
  这不会覆盖交易所提供的可用资金费率，但请记住，设置错误的资金费率将意味着对于无法获得资金费率的历史时间范围，回测结果将不准确。
  
  **开发者**
  
  **保证金模式**
  
  对于空头，支付借入货币利息费用的货币在平仓交易的同时购买 (这意味着空头平仓交易中购买的数量大于空头开仓交易中卖出的数量)。
  
  对于多头，支付借入利息费用的货币将已经由用户拥有，不需要购买。利息将从交易的 `close_value` 中扣除。
  
  所有费用都包含在交易期间的 `current_profit` 计算中。
  
  **期货模式**
  
  资金费用要么添加到交易的总金额中，要么从交易的总金额中扣除。
-