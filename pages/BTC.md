- #btc #crypto
- 比特币在[[中本聪]]的论文[^1]中最先被提出：Bitcoin: A Peer-to-Peer Electronic Cash System。
- 比特币的转移过程:一笔交易可以理解为一个矢量，包括起点和终点，即输入和输出
	- 输入：
		- **指向前序交易的输出：** 每个输入都指向一个或多个之前交易的输出（[[UTXO]] - Unspent Transaction Output），表示要花费的比特币的来源。
		- **解锁脚本**(**ScriptSig**):包含数字签名和公钥，用于证明交易发起者拥有使用该 UTXO 的权限。数字签名是由花费比特币的地址的私钥生成的，公钥用于验证签名的有效性。
	- 输出：
		- **比特币数量 (Value)：** 指定要发送的比特币数量，以聪（Satoshi）为单位（1 比特币 = 1 亿聪）
		- **锁定脚本 (ScriptPubKey)：**  指定接收比特币的地址的条件。通常包含收款人的公钥哈希或脚本哈希。只有满足这些条件的人才能花费这个输出。简单理解，这里定义了谁能花费这笔输出。
	- 例子：假设之前已经有人给A转帐了比特币，现在A要给B转比特币，钱包软件会使用你的私钥对交易数据进行签名，通过[[椭圆曲线数字签名算法]] (ECDSA)生成数字签名，公钥也是由ECDSA通过私钥单向生成的。比特币地址由公钥通过哈希和编码后生成。将UTXO和数字签名和公钥一起作为输入，将目标地址和相应转帐数量作为输出。**通过公钥和数字签名就可以保证这笔交易由私钥持有人发起**。
- 一笔交易广播到网络上之后，矿工会将多笔交易打包到一个块中，新的块包含前一个块的哈希值和多笔交易的信息。矿工会尝试找到一个值，如果该值和区块头一起做[[SHA-256]]哈希运算之后得到的哈希值满足特定条件，矿工就会将该值添加到区块头中并广播该块。
- 当一个矿工挖到一个新的区块后，他会将这个区块广播给他的相邻节点。相邻节点在收到这个区块后，会进行以下验证：
	- **区块结构是否有效：** 检查区块头、交易列表等是否符合协议规范。
	- **工作量证明是否有效：** 检查区块头的哈希值是否满足难度要求。
	- **交易是否有效：** 检查每笔交易的签名、输入输出等是否有效，以及是否与已知的 UTXO 集一致。
	- **是否是最长链：** 检查该区块是否建立在当前已知的最长链上。
- 如果验证通过，节点会将这个区块添加到自己的区块链中，并继续将其广播给其他相邻节点。
- 目前的出块时间稳定在10分钟左右：
	- **目标出块时间：**  比特币协议的设计目标是将出块时间（即产生新区块的时间间隔）稳定在 10 分钟左右。
	- **难度调整机制：**  为了维持这个目标出块时间，比特币协议引入了难度调整机制。每产生 2016 个区块（大约两周时间），网络会根据过去 2016 个区块的实际出块时间来调整挖矿难度。
		- **如果平均出块时间小于 10 分钟：**  说明全网算力增强，难度会相应提高，使得找到符合条件的哈希值更加困难。
		- **如果平均出块时间大于 10 分钟：**  说明全网算力减弱，难度会相应降低，使得找到符合条件的哈希值更加容易。
	- **动态平衡：**  通过这种动态调整机制，比特币网络能够根据全网算力的变化自动调节挖矿难度，从而将出块时间稳定在 10 分钟左右。
	- 为什么：
		- 出块太快：
			- 频繁广播占据带宽
			- 容易分叉降低安全性，降低出块速度利于网络保持同步
		- 出块太慢：
			- 网络单位时间能容纳的交易数量降低，交易费用升高
- 比特币挖矿奖励如何产生：通过[[PoW]]获得记账权，打包多笔交易创建新块，每个区块的第一笔交易是[[Coinbase交易]]。每个区块只能包含一笔 Coinbase 交易，并且必须是区块中的第一笔交易。Coinbase 交易没有输入，Coinbase 交易的输出地址是挖出该区块的矿工控制的地址。Coinbase 交易产生的比特币需要经过 100 个区块的确认后才能被花费。
-
- [^1]https://bitcoin.org/bitcoin.pdf